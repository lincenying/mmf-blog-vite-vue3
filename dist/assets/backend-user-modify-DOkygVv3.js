import{_}from"./a-input.vue_vue_type_script_setup_true_lang-DBNOjAVU.js";import{v as e,h as k,k as N,s as g,g as x,z as y}from"./vendor-CHF6qD04.js";import{u as f}from"./use-backend-user-store-BUfwjutV.js";import{s as v,c as E}from"./main-C4uBXvmg.js";/* empty css               */const h={class:"settings-main card"},M={class:"settings-main-content"},U={class:"settings-footer"},B=e.defineComponent({name:"BackendUserModify",asyncData(u){const{store:d,route:i,api:l}=u;return f(d).getUserItem({id:i.params.id,path:i.fullPath,from:"backend"},l)},__name:"backend-user-modify",setup(u){const d=k(),i=N(),l=f(),m=g(l),n=e.toRef(m,"item"),[V,c]=x(!1),a=e.reactive({id:d.params.id,username:"",email:"",password:""});e.watch(n.value,s=>{s.data&&(a.username=s.data.username,a.email=s.data.email)}),e.onMounted(async()=>{n.value&&n.value.data&&(a.username=n.value.data.username,a.email=n.value.data.email)});async function b(){if(!a.username||!a.email){v("请将表单填写完整!");return}if(V.value)return;c(!0);const{code:s,data:t,message:o}=await E.post("backend/user/modify",a);c(!1),s===200&&(v({type:"success",content:o}),l.updateUserItem(t),i.push("/backend/user/list"))}const p=e.ref("用户编辑 - M.M.F 小屋");return y({title:p,meta:[{name:"description",content:p}]}),(s,t)=>{const o=_,w=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",h,[e.createElementVNode("div",M,[e.createElementVNode("form",null,[e.createVNode(o,{title:"昵称"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>e.unref(a).username=r),type:"text",placeholder:"昵称",class:"base-input",name:"username"},null,512),[[e.vModelText,e.unref(a).username]]),t[3]||(t[3]=e.createElementVNode("span",{class:"input-info error"},"请输入昵称",-1))]),_:1}),e.createVNode(o,{title:"邮箱"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>e.unref(a).email=r),type:"text",placeholder:"邮箱",class:"base-input",name:"email"},null,512),[[e.vModelText,e.unref(a).email]]),t[4]||(t[4]=e.createElementVNode("span",{class:"input-info error"},"请输入邮箱",-1))]),_:1}),e.createVNode(o,{title:"密码"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>e.unref(a).password=r),type:"password",placeholder:"密码",class:"base-input",name:"password"},null,512),[[e.vModelText,e.unref(a).password]]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-info error"},"请输入密码",-1))]),_:1})])]),e.createElementVNode("div",U,[e.createElementVNode("a",{href:"javascript:;",class:"btn btn-yellow",onClick:b},"编辑用户"),e.createVNode(w,{to:"/backend/user/list",class:"btn btn-blue"},{default:e.withCtx(()=>t[6]||(t[6]=[e.createTextVNode("返回")])),_:1})])])}}});export{B as default};
