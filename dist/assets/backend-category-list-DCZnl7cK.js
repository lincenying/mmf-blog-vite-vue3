import{v as e,h as S,s as p,g as N,z as V}from"./vendor-DvyKuS15.js";import{u as _}from"./use-global-category-store-D37QDpdv.js";import{f as b,u as T,c as r,s as y}from"./main-D8-klkuU.js";/* empty css               */const w={class:"card settings-main"},x={class:"settings-main-content"},P={class:"list-time"},$={class:"list-action"},L=["onClick"],M=["onClick"],z=e.defineComponent({name:"BackendCategoryList",asyncData(i){const{store:c,route:l,api:a}=i;return _(c).getCategoryList({limit:99,path:l.fullPath},a)},__name:"backend-category-list",setup(i){const c=S(),l=b(),a=_(),d=p(a),g=e.toRef(d,"lists"),k=p(l),f=e.toRef(k,"historyPageScrollTop");T();const[v,u]=N(!1);async function h(t){v.value||(u(!0),await a.getCategoryList({page:t,limit:99,path:c.fullPath},r),u(!1))}e.onMounted(()=>{if(g.value.length===0)h(1);else{const t=f.value[c.path]||0;window.scrollTo(0,t)}});async function C(t){const{code:s,message:n}=await r.get("backend/category/recover",{id:t});s===200&&(y({type:"success",content:n}),a.recoverCategory(t))}async function E(t){const{code:s,message:n}=await r.get("backend/category/delete",{id:t});s===200&&(y({type:"success",content:n}),a.deleteCategory(t))}const m=e.ref("分类列表 - M.M.F 小屋");return V({title:m,meta:[{name:"description",content:m}]}),(t,s)=>{const n=e.resolveComponent("router-link");return e.openBlock(),e.createElementBlock("div",w,[e.createElementVNode("div",x,[s[1]||(s[1]=e.createElementVNode("div",{class:"list-section list-header"},[e.createElementVNode("div",{class:"list-title"},"分类名称"),e.createElementVNode("div",{class:"list-date"},"分类排序"),e.createElementVNode("div",{class:"list-action"},"操作")],-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.value,o=>(e.openBlock(),e.createElementBlock("div",{key:o._id,class:"list-section"},[e.createElementVNode("div",{class:e.normalizeClass(["list-title",o.is_delete?"text-red-500 line-through":""])},e.toDisplayString(o.cate_name),3),e.createElementVNode("div",P,e.toDisplayString(o.cate_order),1),e.createElementVNode("div",$,[e.createVNode(n,{to:`/backend/category/modify/${o._id}`,class:"badge badge-success"},{default:e.withCtx(()=>s[0]||(s[0]=[e.createTextVNode("编辑")])),_:2},1032,["to"]),o.cate_num?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[o.is_delete?(e.openBlock(),e.createElementBlock("a",{key:0,href:"javascript:;",onClick:B=>C(o._id)},"恢复",8,L)):(e.openBlock(),e.createElementBlock("a",{key:1,href:"javascript:;",onClick:B=>E(o._id)},"删除",8,M))],64))])]))),128))])])}}});export{z as default};
